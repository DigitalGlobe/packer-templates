{
    "builders": [
        {
            "type": "virtualbox-iso",
            "headless": "{{user `headless`}}",
            "boot_command": [
                "<tab> ",
                "text ",
                "ks=http://{{ .HTTPIP }}:{{ .HTTPPort }}/{{user `kickstart_file`}} ",
                "biosdevname=0 ",
                "net.ifnames=0 ",
                "DISK_FS={{user `disk_fs`}} ",
                "LANG={{user `guest_language`}} ",
                "KEYBOARD={{user `guest_keyboard`}} ",
                "TIMEZONE={{user `guest_timezone`}} ",
                "ROOTPW={{user `ssh_root_password`}} ",
                "<enter><wait>"
            ],
            "disk_size": "{{user `disk_size`}}",
            "format": "{{user `format`}}",
            "guest_additions_mode": "{{user `guest_additions_mode`}}",
            "guest_additions_path": "VBoxGuestAdditions.iso",
            "guest_os_type": "RedHat_64",
            "hard_drive_interface": "{{user `hard_drive_interface`}}",
            "http_directory": "www",
            "iso_url": "{{user `iso_url`}}",
            "iso_checksum": "{{user `iso_checksum`}}",
            "iso_checksum_type": "{{user `iso_checksum_type`}}",
            "iso_interface": "sata",
            "post_shutdown_delay": "{{user `post_shutdown_delay`}}",
            "ssh_username": "root",
            "ssh_password": "{{user `ssh_root_password`}}",
            "ssh_wait_timeout": "{{user `ssh_wait_timeout`}}",
            "shutdown_command": "shutdown --no-wall -P now",
            "vm_name": "{{user `vm_name`}}",
            "vboxmanage": [
                ["modifyvm", "{{.Name}}", "--audio", "none"],
                ["modifyvm", "{{.Name}}", "--cpus", "{{user `cpus`}}"],
                ["modifyvm", "{{.Name}}", "--memory", "{{user `memsize`}}"],
                ["modifyvm", "{{.Name}}", "--nictype1", "{{user `nictype`}}"],
                ["modifyvm", "{{.Name}}", "--usb", "off"]
            ],
            "vboxmanage_post": [
                ["modifyvm", "{{.Name}}", "--vrde", "off"],
                ["storagectl", "{{.Name}}", "--name", "IDE Controller", "--remove"]
            ]
        }
    ],
    "provisioners": [
        {
            "type": "shell",
            "environment_vars": [
                "CLOUD_INIT={{user `cloud_init`}}",
                "GUEST_LANG={{user `guest_language`}}",
                "ADMIN_USER={{user `admin_user`}}",
                "ADMIN_USER_AUTHORIZED_KEYS={{user `admin_user_authorized_keys`}}",
                "ADMIN_USER_PASSWORD={{user `admin_user_password`}}",
                "ADMIN_USER_SHELL={{user `admin_user_shell`}}",
                "VBOXGUEST={{user `guest_additions_mode`}}"
            ],
            "scripts": [
                "scripts/centos/yum-update.sh",
                "scripts/centos/cloud-init.sh",
                "scripts/centos/vboxguest.sh",
                "scripts/centos/admin-user.sh",
                "scripts/centos/sshd.sh",
                "scripts/centos/network-config.sh",
                "scripts/centos/tuned.sh",
                "scripts/centos/cleanup.sh",
                "scripts/centos/zerofree.sh",
                "scripts/centos/lock-root-user.sh"
            ]
        }
    ],
    "variables": {
        "admin_user": "vagrant",
        "admin_user_authorized_keys": "ssh-rsa AAAAB3NzaC1yc2EAAAABIwAAAQEA6NF8iallvQVp22WDkTkyrtvp9eWW6A8YVr+kz4TjGYe7gHzIw+niNltGEFHzD8+v1I2YJ6oXevct1YeS0o9HZyN1Q9qgCgzUFtdOKLv6IedplqoPkcmF0aYet2PkEDo3MlTBckFXPITAMzF8dJSIFo9D8HfdOV0IAdx4O7PtixWKn5y2hMNG0zQPyUecp4pzC6kivAIhyfHilFR61RGL+GPXQ2MWZWFYbAGjyiYJnAmCP3NOTd0jMZEnDkbUvxhMmBYSdETk1rRgm+R4LOzFUGaHqHDLKLX+FIPKcF96hrucXzcWyLbIbEgE98OHlnVYCzRdK8jlqm8tehUc9c9WhQ== vagrant insecure public key",
        "admin_user_password": "vagrant",
        "admin_user_shell": "/bin/bash",
        "cloud_init": "no",
        "cpus": "1",
        "disk_fs": "xfs",
        "disk_size": "8192",
        "format": "ovf",
        "guest_additions_mode": "upload",
        "guest_keyboard": "us",
        "guest_timezone": "UTC",
        "guest_language": "en_US.UTF-8",
        "hard_drive_interface": "sata",
        "headless": "false",
        "iso_checksum": "bba314624956961a2ea31dd460cd860a77911c1e0a56e4820a12b9c5dad363f5",
        "iso_checksum_type": "sha256",
        "iso_url": "https://mirrors.kernel.org/centos/7.4.1708/isos/x86_64/CentOS-7-x86_64-Minimal-1708.iso",
        "kickstart_file": "ks.cfg",
        "memsize": "512",
        "nictype": "virtio",
        "post_shutdown_delay": "10s",
        "ssh_root_password": "vagrant",
        "ssh_wait_timeout": "10m",
        "vm_name": "centos7-minimal"
    }
}
