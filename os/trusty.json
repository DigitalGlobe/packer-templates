{
    "builders": [
        {
            "boot_command": [
                "<esc><esc><enter><wait>",
                "/install/vmlinuz ",
                "noapic ",
                "auto=true ",
                "url={{ .HTTPIP }}:{{ .HTTPPort }}/{{user `preseed_file`}} ",
                "apt-setup/security_host={{user `mirror_hostname`}} ",
                "apt-setup/security_path={{user `mirror_directory`}} ",
                "console-setup/layoutcode={{user `guest_keyboard`}} ",
                "debian-installer/locale={{user `guest_language`}} ",
                "base-installer/kernel/override-image={{user `kernel_package`}} ",
                "keyboard-configuration/layoutcode={{user `guest_keyboard`}} ",
                "hostname={{user `vm_name`}} ",
                "mirror/http/directory={{user `mirror_directory`}} ",
                "mirror/http/hostname={{user `mirror_hostname`}} ",
                "time/zone={{user `guest_timezone`}} ",
                "partman-auto/method={{user `disk_type`}} ",
                "passwd/root-password=\"{{user `admin_user_password`}}\" ",
                "passwd/root-password-again=\"{{user `admin_user_password`}}\" ",
                "preseed/late_command=\"",
                "in-target wget -q -O /tmp/postinstall.sh http://{{ .HTTPIP }}:{{ .HTTPPort }}/{{user `postinstall_script`}} ; ",
                "in-target KERNEL_PACKAGE={{user `kernel_package`}} /bin/sh /tmp/postinstall.sh; \" ",
                "initrd=/install/initrd.gz -- ",
                "biosdevname=0 ",
                "net.ifnames=0 ",
                "<enter>"
            ]
        }
    ],
    "provisioners": [
        {
            "type": "shell",
            "environment_vars": [
                "CLOUD_INIT={{user `cloud_init`}}",
                "ADMIN_USER={{user `admin_user`}}",
                "ADMIN_USER_AUTHORIZED_KEYS={{user `admin_user_authorized_keys`}}",
                "ADMIN_USER_PASSWORD={{user `admin_user_password`}}",
                "ADMIN_USER_SHELL={{user `admin_user_shell`}}",
                "VBOXGUEST={{user `guest_additions_mode`}}"
            ],
            "scripts": [
                "scripts/common/admin-user.sh"
            ]
        }
    ],
    "variables": {
        "disk_type": "lvm",
        "guest_os_type": "Ubuntu_64",
        "kernel_package": "linux-virtual",
        "mirror_hostname": "us.archive.ubuntu.com",
        "mirror_directory": "/ubuntu/",
        "iso_checksum": "946a6077af6f5f95a51f82fdc44051c7aa19f9cfc5f737954845a6050543d7c2",
        "iso_url": "http://old-releases.ubuntu.com/releases/14.04.1/ubuntu-14.04.1-server-amd64.iso",
        "preseed_file": "preseed.cfg",
        "postinstall_script": "postinstall.sh",
        "shutdown_command": "sudo shutdown -P now"
    }
}
